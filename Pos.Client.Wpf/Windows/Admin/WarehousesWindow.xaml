<Window x:Class="Pos.Client.Wpf.Windows.Admin.WarehousesWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Warehouses" Height="720" Width="1024"
        WindowStartupLocation="CenterOwner"
        KeyDown="Window_KeyDown">
    <DockPanel>

        <!-- Search row (auto-hidden unless grid has vertical scrollbar) -->
        <DockPanel x:Name="SearchRow"
                   DockPanel.Dock="Top"
                   Margin="8,8,8,0"
                   Visibility="Collapsed">
            <TextBlock Text="Search:" VerticalAlignment="Center" Margin="0,0,6,0"/>
            <TextBox x:Name="SearchBox"
                     Width="240"
                     VerticalContentAlignment="Center"
                     ToolTip="Search by name/code/city/phone"
                     TextChanged="SearchBox_TextChanged"/>
        </DockPanel>

        <!-- Toolbar (same compact style used elsewhere) -->
        <ToolBar DockPanel.Dock="Top"
                 Style="{StaticResource ModernToolBar.Compact}"
                 ToolBarTray.IsLocked="True"
                 Margin="8,8,8,6">
            <Button x:Name="AddBtn"
                    Content="Add"
                    Width="90"
                    Click="Add_Click"/>

            <Button x:Name="EditBtn"
                    Content="Edit"
                    Width="90" Margin="6,0,0,0"
                    Click="Edit_Click"
                    Visibility="Collapsed"/>

            

            <Button x:Name="EnableBtn"
                    Content="Enable"
                    Width="90" Margin="0,0,6,0"
                    Click="Enable_Click"
                    Visibility="Collapsed"/>

            <Button x:Name="DisableBtn"
                    Content="Disable"
                    Width="90"
                    Click="Disable_Click"
                    Visibility="Collapsed"/>

            <Separator/>

            <CheckBox x:Name="ShowInactive"
                      Content="Show inactive"
                      Margin="6,0,0,0"
                      Checked="FilterChanged" Unchecked="FilterChanged"/>
        </ToolBar>

        <!-- Grid (compact, two-line cells like Outlets/Counters) -->
        <DataGrid x:Name="WarehousesGrid"
                  Margin="8"
                  Style="{StaticResource Grid.ListCompact}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  SelectionMode="Single"
                  SelectionChanged="Grid_SelectionChanged"
                  MouseDoubleClick="Grid_MouseDoubleClick"
                  SizeChanged="WarehousesGrid_SizeChanged"
                  Loaded="WarehousesGrid_Loaded">

            <DataGrid.Columns>
                <!-- One templated column with two lines: NAME + badge | Code, City, Phone -->
                <DataGridTemplateColumn Header="Warehouse" Width="*">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Grid Margin="0,2,0,2">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- Line 1: NAME   [Active/Inactive]                 Code (right) -->
                                <StackPanel Orientation="Horizontal" Grid.Row="0" Grid.Column="0">
                                    <TextBlock FontWeight="SemiBold" Text="{Binding Name}"/>
                                    <Border Style="{StaticResource Badge.ActiveInactive}" Margin="8,0,0,0">
                                        <TextBlock FontSize="11" Margin="4,0,4,0" Foreground="{StaticResource Badge.Text}">
                                            <TextBlock.Style>
                                                <Style TargetType="TextBlock">
                                                    <Setter Property="Text" Value="Inactive"/>
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding IsActive}" Value="True">
                                                            <Setter Property="Text" Value="Active"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </TextBlock.Style>
                                        </TextBlock>
                                    </Border>
                                </StackPanel>

                                <!-- Code on the far right (same row) -->
                                <TextBlock Grid.Row="0" Grid.Column="1"
                                           Text="{Binding Code}"
                                           FontWeight="SemiBold"
                                           Margin="8,0,0,0"
                                           HorizontalAlignment="Right"
                                           VerticalAlignment="Center"/>

                                <!-- Line 2: City • Phone • Note (muted) -->
                                <TextBlock Grid.Row="1" Grid.ColumnSpan="2"
                                           Style="{StaticResource Txt.MutedSmall}"
                                           TextTrimming="CharacterEllipsis">
                                    <TextBlock.Inlines>
                                        <Run Text="{Binding City}"/>
                                        <Run Text=" "/>
                                        <Run Text="•"/>
                                        <Run Text=" "/>
                                        <Run Text="{Binding Phone}"/>
                                        <Run Text="  "/>
                                        <Run Text="—"/>
                                        <Run Text=" "/>
                                        <Run Text="{Binding Note}"/>
                                    </TextBlock.Inlines>
                                </TextBlock>
                            </Grid>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </DockPanel>
</Window>
