<Window x:Class="Pos.Client.Wpf.Windows.Inventory.TransferPickerWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Find Transfers" Width="1000" Height="620"
        WindowStartupLocation="CenterOwner" ResizeMode="CanResizeWithGrip"
        MinWidth="900" MinHeight="520">
    <DockPanel>
        <!-- Filters -->
        <Border DockPanel.Dock="Top" Padding="10" Background="{DynamicResource {x:Static SystemColors.ControlBrushKey}}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <TextBox x:Name="SearchBox" Grid.Column="0" Grid.Row="0" Height="28" Margin="0,0,8,0"
                         />
                <ComboBox x:Name="StatusBox" Grid.Column="1" Grid.Row="0" Height="28" Margin="0,0,8,0">
                    <ComboBoxItem Content="Any" IsSelected="True"/>
                    <ComboBoxItem Content="Draft"/>
                    <ComboBoxItem Content="Dispatched"/>
                    <ComboBoxItem Content="Received"/>
                </ComboBox>
                <StackPanel Grid.Column="2" Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left">
                    <TextBlock Text="From: " VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <ComboBox x:Name="FromTypeBox" Width="120" Height="28" Margin="0,0,6,0">
                        <ComboBoxItem Content="Any" IsSelected="True"/>
                        <ComboBoxItem Content="Warehouse"/>
                        <ComboBoxItem Content="Outlet"/>
                    </ComboBox>
                    <ComboBox x:Name="FromPicker" Width="180" Height="28" DisplayMemberPath="Name" SelectedValuePath="Id"/>
                </StackPanel>

                <StackPanel Grid.Column="3" Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Left">
                    <TextBlock Text="To: " VerticalAlignment="Center" Margin="0,0,6,0"/>
                    <ComboBox x:Name="ToTypeBox" Width="120" Height="28" Margin="0,0,6,0">
                        <ComboBoxItem Content="Any" IsSelected="True"/>
                        <ComboBoxItem Content="Warehouse"/>
                        <ComboBoxItem Content="Outlet"/>
                    </ComboBox>
                    <ComboBox x:Name="ToPicker" Width="180" Height="28" DisplayMemberPath="Name" SelectedValuePath="Id"/>
                </StackPanel>

                <StackPanel Grid.Column="4" Grid.Row="0" Orientation="Horizontal">
                    <DatePicker x:Name="FromDate" Width="140" Margin="0,0,6,0"/>
                    <DatePicker x:Name="ToDate" Width="140"/>
                </StackPanel>

                <StackPanel Grid.Column="5" Grid.Row="0" Orientation="Horizontal">
                    <Button x:Name="BtnSearch" Content="Search" Width="90" Margin="8,0,0,0" Click="BtnSearch_Click"/>
                </StackPanel>

                <TextBlock Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="6" Margin="0,8,0,0"
                           Foreground="Gray"
                           Text="Tip: Double-click a row or press Enter to open. Date range filters by Dispatch date (EffectiveDate)."/>
            </Grid>
        </Border>

        <!-- Grid -->
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <DataGrid x:Name="Grid"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      IsReadOnly="True"
                      MouseDoubleClick="Grid_MouseDoubleClick"
                      KeyDown="Grid_KeyDown">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="No" Width="160" Binding="{Binding TransferNo}"/>
                    <DataGridTextColumn Header="Status" Width="110" Binding="{Binding Status}"/>
                    <DataGridTextColumn Header="From" Width="*" Binding="{Binding FromDisplay}"/>
                    <DataGridTextColumn Header="To" Width="*" Binding="{Binding ToDisplay}"/>
                    <DataGridTextColumn Header="Dispatch" Width="160"
                        Binding="{Binding EffectiveDateUtc, StringFormat=\{0:yyyy-MM-dd HH:mm\}}"/>
                    <DataGridTextColumn Header="Received" Width="160"
                        Binding="{Binding ReceivedAtUtc, StringFormat=\{0:yyyy-MM-dd HH:mm\}}"/>
                    <DataGridTextColumn Header="Lines" Width="70" Binding="{Binding LineCount}"/>
                    <DataGridTextColumn Header="Qty Exp" Width="100"
                        Binding="{Binding QtyExpectedSum, StringFormat=\{0:0.####\}}"/>
                    <DataGridTextColumn Header="Qty Rec" Width="100"
                        Binding="{Binding QtyReceivedSum, StringFormat=\{0:0.####\}}"/>
                    <DataGridTextColumn Header="First Item" Width="220" Binding="{Binding FirstItem}"/>
                </DataGrid.Columns>
            </DataGrid>

            <DockPanel Grid.Row="1" LastChildFill="False" Margin="0,8,0,0">
                <TextBlock x:Name="TotalText" DockPanel.Dock="Left" VerticalAlignment="Center" />
                <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <Button x:Name="BtnOk" Content="Open" Width="90" Margin="8,0,0,0" Click="BtnOk_Click"/>
                    <Button Content="Cancel" Width="90" Margin="8,0,0,0" IsCancel="True"/>
                </StackPanel>
            </DockPanel>
        </Grid>
    </DockPanel>
</Window>
